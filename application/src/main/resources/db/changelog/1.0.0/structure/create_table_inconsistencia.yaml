databaseChangeLog:
  - changeSet:
      id: create_table_inconsistencia
      author: erickmendes
      preConditions:
        - onFail: MARK_RAN
          not:
            tableExists:
              tableName: inconsistencia
      changes:
        - createTable:
            tableName: inconsistencia
            columns:
              - column:
                  name: id
                  type: BIGINT
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: inconsistencia_pk
              - column:
                  name: data
                  type: DATE
                  constraints:
                    nullable: false
              - column:
                  name: processamento_id
                  type: BIGINT
                  constraints:
                    nullable: false
              - column:
                  name: inconsistencia_tipo_id
                  type: BIGINT
                  constraints:
                    nullable: false
              - column:
                  name: cnpj
                  type: VARCHAR(50)
                  constraints:
                    nullable: false
              - column:
                  name: registro_destino_inconsistente
                  type: TEXT
              - column:
                  name: registro_origem_inconsistente
                  type: TEXT
              - column:
                  name: detalhes
                  type: TEXT
              - column:
                  name: total_registros
                  type: BIGINT
              - column:
                  name: registro_destino_completo
                  type: TEXT
              - column:
                  name: registro_origem_completo
                  type: TEXT
        - addForeignKeyConstraint:
            constraintName: fk_empresa_processamento
            baseTableName: inconsistencia
            baseColumnNames: cnpj
            referencedTableName: empresa
            referencedColumnNames: cnpj
            validate: true
        - addForeignKeyConstraint:
            constraintName: fk_inconsistencia_inconsistencia_tipo
            baseTableName: inconsistencia
            baseColumnNames: inconsistencia_tipo_id
            referencedTableName: inconsistencia_tipo
            referencedColumnNames: id
            validate: true
        - addForeignKeyConstraint:
            constraintName: fk_inconsistencia_processamento
            baseTableName: inconsistencia
            baseColumnNames: processamento_id
            referencedTableName: processamento
            referencedColumnNames: id
            validate: true
  - changeSet:
      id: create_inconsistencia_id_seq
      author: erickmendes
      preConditions:
        - onFail: MARK_RAN
          not:
            sequenceExists:
              sequenceName: inconsistencia_id_seq
      changes:
        - createSequence:
            incrementBy: 1
            minValue: 1
            sequenceName: inconsistencia_id_seq