databaseChangeLog:
  - changeSet:
      id: 1
      author: luccakominek
      preConditions:
        onFail: MARK_RAN
        not:
          sequenceExists:
            sequenceName: organizacao_id_seq
      changes:
        - createSequence:
            sequenceName: organizacao_id_seq
            startValue: 1
        - preConditions:
            onFail: MARK_RAN
            not:
              tableExists:
                tableName: organizacao
        - createTable:
            tableName: organizacao
            columns:
              - column:
                  name: id
                  type: bigint
                  constraints:
                    primaryKey: true
                    nullable: false
                  autoIncrement: true
              - column:
                  name: nome
                  type: varchar
                  constraints:
                    nullable: false

  - changeSet:
      id: 2
      author: luccakominek
      preConditions:
        onFail: MARK_RAN
        not:
          sequenceExists:
            sequenceName: usuario_id_seq
      changes:
        - createSequence:
            sequenceName: usuario_id_seq
            startValue: 1
        - preConditions:
            onFail: MARK_RAN
            not:
              tableExists:
                tableName: usuario
        - createTable:
            tableName: usuario
            columns:
              - column:
                  name: id
                  type: bigint
                  constraints:
                    primaryKey: true
                    nullable: false
                  autoIncrement: true
              - column:
                  name: nome
                  type: varchar
                  constraints:
                    nullable: false
              - column:
                  name: email
                  type: varchar
                  constraints:
                    nullable: false
              - column:
                  name: keycloak_id
                  type: UUID
                  constraints:
                    nullable: true

  - changeSet:
      id: 3
      author: luccakominek
      preConditions:
        onFail: MARK_RAN
        not:
          sequenceExists:
            sequenceName: projeto_id_seq
      changes:
        - createSequence:
            sequenceName: projeto_id_seq
            startValue: 1
        - preConditions:
            onFail: MARK_RAN
            not:
              tableExists:
                tableName: projeto
        - createTable:
            tableName: projeto
            columns:
              - column:
                  name: id
                  type: bigint
                  constraints:
                    primaryKey: true
                    nullable: false
                  autoIncrement: true
              - column:
                  name: nome
                  type: varchar
                  constraints:
                    nullable: false
              - column:
                  name: organizacao_id
                  type: bigint
                  constraints:
                    nullable: false
        - addForeignKeyConstraint:
            baseTableName: projeto
            baseColumnNames: organizacao_id
            constraintName: projeto_organizacao_fk
            referencedTableName: organizacao
            referencedColumnNames: id

  - changeSet:
      id: 4
      author: luccakominek
      preConditions:
        onFail: MARK_RAN
        not:
          sequenceExists:
            sequenceName: subclassificacao_id_seq
      changes:
        - createSequence:
            sequenceName: subclassificacao_id_seq
            startValue: 4
        - preConditions:
            onFail: MARK_RAN
            not:
              tableExists:
                tableName: subclassificacao
        - createTable:
            tableName: subclassificacao
            columns:
              - column:
                  name: id
                  type: bigint
                  constraints:
                    primaryKey: true
                    nullable: false
                  autoIncrement: true
              - column:
                  name: nome
                  type: varchar
                  constraints:
                    nullable: true

  - changeSet:
      id: 5
      author: luccakominek
      preConditions:
        onFail: MARK_RAN
        not:
          sequenceExists:
            sequenceName: classificacao_id_seq
      changes:
        - createSequence:
            sequenceName: classificacao_id_seq
            startValue: 1
        - preConditions:
            onFail: MARK_RAN
            not:
              tableExists:
                tableName: classificacao
        - createTable:
            tableName: classificacao
            columns:
              - column:
                  name: id
                  type: bigint
                  constraints:
                    primaryKey: true
                    nullable: false
                  autoIncrement: true
              - column:
                  name: nome
                  type: varchar
                  constraints:
                    nullable: true
              - column:
                  name: subclassificacao_id
                  type: bigint
                  constraints:
                    nullable: false
        - addForeignKeyConstraint:
            baseTableName: classificacao
            baseColumnNames: subclassificacao_id
            constraintName: classificacao_subclassificacao_fk
            referencedTableName: subclassificacao
            referencedColumnNames: id

  - changeSet:
      id: 6
      author: luccakominek
      preConditions:
        onFail: MARK_RAN
        not:
          sequenceExists:
            sequenceName: tarefa_id_seq
      changes:
        - createSequence:
            sequenceName: tarefa_id_seq
            startValue: 1
        - preConditions:
            onFail: MARK_RAN
            not:
              tableExists:
                tableName: tarefa
        - createTable:
            tableName: tarefa
            columns:
              - column:
                  name: id
                  type: bigint
                  constraints:
                    primaryKey: true
                    nullable: false
                  autoIncrement: true
              - column:
                  name: titulo
                  type: varchar
                  constraints:
                    nullable: false
              - column:
                  name: descricao
                  type: varchar
                  constraints:
                    nullable: false
              - column:
                  name: so
                  type: varchar
                  constraints:
                    nullable: true
              - column:
                  name: screenshots
                  type: bytea[]
                  constraints:
                    nullable: true
              - column:
                  name: caminho
                  type: varchar
                  constraints:
                    nullable: true
              - column:
                  name: data_fechamento
                  type: date
                  constraints:
                    nullable: true
              - column:
                  name: data_criacao
                  type: date
                  constraints:
                    nullable: false
              - column:
                  name: data_estimada
                  type: date
                  constraints:
                    nullable: true
              - column:
                  name: prioridade
                  type: bigint
                  constraints:
                    nullable: false
              - column:
                  name: status
                  type: bigint
                  constraints:
                    nullable: false
              - column:
                  name: fechada
                  type: boolean
                  constraints:
                    nullable: false
              - column:
                  name: posicao
                  type: bigint
                  constraints:
                    nullable: true
              - column:
                  name: projeto_id
                  type: bigint
                  constraints:
                    nullable: false
              - column:
                  name: feedback
                  type: text
                  constraints:
                    nullable: true
              - column:
                  name: classificacao_id
                  type: bigint
                  constraints:
                    nullable: true
        - addForeignKeyConstraint:
            baseTableName: tarefa
            baseColumnNames: projeto_id
            constraintName: tarefa_projeto_fk
            referencedTableName: projeto
            referencedColumnNames: id
        - addForeignKeyConstraint:
            baseTableName: tarefa
            baseColumnNames: classificacao_id
            constraintName: tarefa_classificacao_fk
            referencedTableName: classificacao
            referencedColumnNames: id

  - changeSet:
      id: 7
      author: luccakominek
      preConditions:
        onFail: MARK_RAN
        not:
          tableExists:
            tableName: usuario_tarefa
      changes:
        - createTable:
            tableName: usuario_tarefa
            columns:
              - column:
                  name: usuario_id
                  type: bigint
                  constraints:
                    nullable: false
              - column:
                  name: tarefa_id
                  type: bigint
                  constraints:
                    nullable: false
        - addForeignKeyConstraint:
            baseTableName: usuario_tarefa
            baseColumnNames: usuario_id
            constraintName: usuario_tarefa_usuario_fk
            referencedTableName: usuario
            referencedColumnNames: id
        - addForeignKeyConstraint:
            baseTableName: usuario_tarefa
            baseColumnNames: tarefa_id
            constraintName: usuario_tarefa_tarefa_fk
            referencedTableName: tarefa
            referencedColumnNames: id

  - changeSet:
      id: 8
      author: luccakominek
      preConditions:
        onFail: MARK_RAN
        not:
          sequenceExists:
            sequenceName: comentario_id_seq
      changes:
        - createSequence:
            sequenceName: comentario_id_seq
            startValue: 1
        - preConditions:
            onFail: MARK_RAN
            not:
              tableExists:
                tableName: comentario
        - createTable:
            tableName: comentario
            columns:
              - column:
                  name: id
                  type: bigint
                  constraints:
                    primaryKey: true
                    nullable: false
                  autoIncrement: true
              - column:
                  name: conteudo
                  type: TEXT
                  constraints:
                    nullable: true
              - column:
                  name: tarefa_id
                  type: bigint
                  constraints:
                    nullable: false
              - column:
                  name: data_criacao
                  type: timestamp
                  constraints:
                    nullable: false
              - column:
                  name: usuario_id
                  type: bigint
                  constraints:
                    nullable: false
        - addForeignKeyConstraint:
            baseTableName: comentario
            baseColumnNames: tarefa_id
            constraintName: comentario_tarefa_fk
            referencedTableName: tarefa
            referencedColumnNames: id
        - addForeignKeyConstraint:
            baseTableName: comentario
            baseColumnNames: usuario_id
            constraintName: comentario_usuario_fk
            referencedTableName: usuario
            referencedColumnNames: id

  - changeSet:
      id: 9
      author: luccakominek
      preConditions:
        onFail: MARK_RAN
        not:
          tableExists:
            tableName: usuario_projeto
      changes:
        - createTable:
            tableName: usuario_projeto
            columns:
              - column:
                  name: usuario_id
                  type: bigint
                  constraints:
                    nullable: false
              - column:
                  name: projeto_id
                  type: bigint
                  constraints:
                    nullable: false
        - addForeignKeyConstraint:
            baseTableName: usuario_projeto
            baseColumnNames: usuario_id
            constraintName: usuario_projeto_usuario_fk
            referencedTableName: usuario
            referencedColumnNames: id
        - addForeignKeyConstraint:
            baseTableName: usuario_projeto
            baseColumnNames: projeto_id
            constraintName: usuario_projeto_projeto_fk
            referencedTableName: projeto
            referencedColumnNames: id